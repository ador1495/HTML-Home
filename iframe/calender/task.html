<style>
	body {
		margin: 16px;
		font-family: Arial, Helvetica, sans-serif;
		background: #121212;
		color: #e0e0e0;
		background-color: #141414;
	}
	button, input, select, textarea {
		background-color: #222;
		color: #eee;
		border: 1px solid #444;
		border-radius: 6px;
		padding: 4px 6px;
		font-size: 14px;
	}
	.progress-container {
		position: relative;
		margin: 8px;
		min-width: 200px;
		height: 12px;
		background: #222222;
		border-radius: 5px;
	}
	.progress {
		width: 0%;
		height: 100%;
		background-color: #555;
		border-radius: 5px;
		cursor: pointer;
	}
	marks {
		display: flex;
		flex-direction: column;
		position: absolute;
		top: -8px;
		height: 0px;
	}
	marks line {
		width: 1px;
		min-height: 32px;
		background: #bbb;
		border: 1px solid black;
	}
	marks label {
		border: 1px solid #333;
		padding: 5px;
		transform: translateX(-50%);
		text-align: center;
	}
	left {
		display: flex;
		flex-direction: column;
		width: 100%;
		height: 100%;
	}
	t {
		display: flex;
		margin-top: 76px;
		gap: 16px;
		height: 200px;
		width: 950px;
		max-width: 950px;
		overflow: auto;
		scrollbar-width: none;
	}
	t div {
		border: 1px solid gray;
		display: flex;
		flex-direction: column;
		width: 135px;
		padding: 2px;
		gap: 4px;
		text-align: center;
	}
	t div h {
		margin-bottom: 6px;
		white-space: nowrap;
		overflow: hidden;
	}
</style>

<left>
	<label id="weather"></label>
	<div class="progress-container">
		<div id="progress" class="progress"></div>
		<div id="mg">
			<marks style="left: 430px;" class="">
				<line></line>
				<label contenteditable="true">13:00<br>Johr</label>
			</marks>
			<marks class="" style="left: 48px;">
				<line></line>
				<label contenteditable="true">05:00<br>Fajr</label>
			</marks>
			<marks class="" style="left: 610px;">
				<line></line>
				<label contenteditable="true">16:45<br>Asr</label>
			</marks>
			<marks class="" style="left: 669px;">
				<line></line>
				<label contenteditable="true">18:00<br>Magrib</label>
			</marks>
			<marks class="" style="left: 776px;">
				<line></line>
				<label contenteditable="true">20:15<br>Asa</label>
			</marks>
		</div>
	</div>
	<t tabindex="0"></t>
	<div></div>
</left>

<script>
	const timeProgress = document.getElementById("progress"), timeContainer = document.querySelector(".progress-container"), p = document.querySelector("t"); let t = [];
	if (localStorage.getItem("note")) {t = JSON.parse(localStorage.getItem("note")).t; t.forEach(text => {
		const filename = text.split("\\").pop().split(".")[0], script = document.createElement("script");;
		p.insertAdjacentHTML("beforeend", `
			<div class="file-block fb-${filename}">
				<h contenteditable="true" class="th">${filename}</h> 
				<label class="tl tl${filename}">01 0:00 360</label>
				<input class="ti ti${filename}">
				<label>File Path: <button onclick="navigator.clipboard.writeText('${text}')">Copy</button></label>
			</div>
		`);
		script.src = text; script.dataset.t = filename; p.appendChild(script);
		script.onerror = () => { const block = p.querySelector(`.fb-${filename}`);
			if (block) block.remove(); t = t.filter(item => item !== text); localStorage.setItem("note", JSON.stringify({ t }));
		};
	})}
	p.addEventListener('paste', (e) => {e.preventDefault();
		let text = e.clipboardData.getData("text"); text = text.replace(/^"(.*)"$/, "$1");
		if (text.endsWith(".js") && !t.includes(text)) {
			const filename = text.split("\\").pop().split(".")[0], script = document.createElement("script");;
			p.insertAdjacentHTML("beforeend", `
				<div class="file-block fb-${filename}">
					<h contenteditable="true" class="th">${filename}</h> 
					<label class="tl tl${filename}">01 0:00 360</label>
					<input class="ti ti${filename}">
					<label>File Path: <button onclick="navigator.clipboard.writeText('${text}')">Copy</button></label>
				</div>
			`);
			script.src = text; script.dataset.t = filename; p.appendChild(script);
			script.onerror = () => {const block = p.querySelector(`.fb-${filename}`);if (block) block.remove()} 
			script.onload = () => {t.push(text); localStorage.setItem("note", JSON.stringify({ t }))}
		}
	});
	let markgroup = document.getElementById("mg"), newMark = false;
	if (localStorage.getItem("marks")) markgroup.innerHTML = localStorage.getItem("marks");
	document.querySelectorAll('#mg label').forEach(lab => {lab.addEventListener('blur', ()=>{lab.parentNode.className="";if (lab.innerText.trim() == "") lab.parentNode.remove();localStorage.setItem("marks", markgroup.innerHTML)}); lab.addEventListener("click", () => {lab.parentNode.className="temp"})})
	
	function updateProgress(){
		let time = new Date();
		timeProgress.style.width = (((time.getHours() * 60) + time.getMinutes()) - 240)/12 + 1 + "%";
	}
	updateProgress(); document.addEventListener("visibilitychange", () => updateProgress());
	timeContainer.addEventListener("mousedown", (e) => {
		if (newMark){
			const temp = document.querySelector('.temp');
			if (temp) temp.className = "";
			newMark = false;
		} else {
			let mg = document.querySelectorAll('#mg label'); newMark = true;
			if (e.target == timeContainer || e.target == timeProgress){
				const timeProgress = document.getElementById("progress");
				const rect = timeProgress.getBoundingClientRect();
				document.querySelector('#mg').innerHTML += `
				<marks class="temp" style="left: ${e.clientX - rect.left}px;">
					<line></line>
					<label contenteditable="true"></label>
				</marks>`;
				document.querySelectorAll('#mg label').forEach(lab => {lab.addEventListener('blur', ()=>{lab.parentNode.className="";if (lab.innerText.trim() == "") lab.parentNode.remove();localStorage.setItem("marks", markgroup.innerHTML)}); lab.addEventListener("click", () => {lab.parentNode.className="temp"})})
			}
		}
	})
	timeContainer.addEventListener("mousemove", (e) => {
		if (e.target == timeContainer || e.target == timeProgress){
			const rect = timeContainer.getBoundingClientRect(), temp = document.querySelector('.temp');
			if (temp){
				temp.style.left = e.clientX - rect.left + "px";
				let time = (((e.clientX - rect.left)/rect.width*100)*12)+240, hour = Math.floor(time/60), minute = Math.floor(Math.floor(time%60)/5)*5, lab = document.querySelector(".temp label");
				if (lab) {let i = lab.innerHTML.split("<br>"), j=""; if (i.length == 1) {j=i[0]} else {for (let k = 1; k<i.length; k++){j+=i[k]}}; lab.innerHTML = `${String(hour).padStart(2, "0")}:${String(minute).padStart(2, "0")}<br>${j}`}
			}
		}
	})
	const weatherLabel = document.getElementById('weather');
	async function loadWeather() {
	  // Example: Dhaka
	  const lat = 23.8103;
	  const lon = 90.4125;

	  // Fetch current weather + hourly humidity + apparent temperature
	  const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&hourly=relativehumidity_2m,apparent_temperature`;
	  const res = await fetch(url);
	  const data = await res.json();

	  // Current weather
	  const temp = data.current_weather.temperature;
	  const wind = data.current_weather.windspeed;
	  const code = data.current_weather.weathercode;
	  const now = new Date();
		const utcHour = now.getUTCHours();
		const dayIndex = 0;
		const hourIndex = dayIndex * 24 + utcHour;

		const humidity = data.hourly.relativehumidity_2m[hourIndex];
		const feelsLike = data.hourly.apparent_temperature[hourIndex];


	  // Map weather code to description
	  const conditions = {
		0: "Clear sky ☀️",
		1: "Mainly clear 🌤",
		2: "Partly cloudy ⛅",
		3: "Overcast ☁️",
		45: "Fog 🌫", 48: "Rime fog 🌫",
		51: "Light drizzle 🌦", 53: "Moderate drizzle 🌦", 55: "Dense drizzle 🌧",
		56: "Light freezing drizzle ❄️", 57: "Dense freezing drizzle ❄️",
		61: "Slight rain 🌧", 63: "Moderate rain 🌧", 65: "Heavy rain 🌧",
		66: "Light freezing rain ❄️", 67: "Heavy freezing rain ❄️",
		71: "Slight snowfall ❄️", 73: "Moderate snowfall ❄️", 75: "Heavy snowfall ❄️",
		77: "Snow grains ❄️",
		80: "Slight rain shower 🌦", 81: "Moderate rain shower 🌦", 82: "Violent rain shower 🌧",
		85: "Slight snow shower ❄️", 86: "Heavy snow shower ❄️",
		95: "Thunderstorm ⛈", 96: "Thunderstorm w/ slight hail ⛈", 99: "Thunderstorm w/ heavy hail ⛈"
	  };

	  const condition = conditions[code] || `Unknown (${code})`;
	  weatherLabel.innerText = `Weather Condition is ${condition} ${temp}°C , ${wind} km/h wind , ${humidity}% humidity Feels like ${feelsLike}°C`;
	}
	loadWeather();
</script>
